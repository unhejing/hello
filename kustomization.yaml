apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

metadata:
  name: hello-app
  namespace: default

resources:
  - deployment.yaml
  - service.yaml
  - configmap.yaml

# 动态生成 ConfigMap（用于验证 Kustomize 是否生效）
configMapGenerator:
  - name: hello-env-config
    literals:
      - APP_NAME=hello-app
      - DEPLOYED_BY=ArgoCD
      - KUSTOMIZE_VERSION=v1.0.0
      - DEPLOY_TIME=2025-12-27
      - ENVIRONMENT=production
    # 注意：configMapGenerator 不支持 labels 字段
    # 标签会通过 commonLabels 自动应用到生成的 ConfigMap

commonLabels:
  app: hello-app
  managed-by: argocd
  generated-by: kustomize  # 这个标签会自动应用到所有资源，包括生成的 ConfigMap

# 添加命名空间（可选）
namespace: default

